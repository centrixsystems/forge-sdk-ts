#!/usr/bin/env bash
# commit-msg hook: Strip Claude/AI attribution from commit messages
# Company policy: commits must not contain AI co-author or attribution lines

COMMIT_MSG_FILE="$1"

# Remove Co-Authored-By lines referencing Claude/Anthropic/AI
sed -i.bak '/Co-Authored-By:.*[Cc]laude/d' "$COMMIT_MSG_FILE"
sed -i.bak '/Co-Authored-By:.*[Aa]nthropic/d' "$COMMIT_MSG_FILE"
sed -i.bak '/Co-Authored-By:.*noreply@anthropic\.com/d' "$COMMIT_MSG_FILE"

# Remove any trailing blank lines left behind
sed -i.bak -e :a -e '/^\n*$/{$d;N;ba' -e '}' "$COMMIT_MSG_FILE"

# Clean up sed backup files
rm -f "${COMMIT_MSG_FILE}.bak"

exit 0
